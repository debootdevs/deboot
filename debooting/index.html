<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://debootdevs.github.io/deboot/debooting/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>DeBooting - DeBoot</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "DeBooting";
        var mkdocs_page_input_path = "debooting.md";
        var mkdocs_page_url = "/deboot/debooting/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> DeBoot
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../booting/">How booting works</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../deboot/">How DeBoot works</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Boot Stages</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../metal/">Metal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uefi/">UEFI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../grub/">GRUB</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../u-boot/">U-Boot</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../initramfs/">Initramfs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Using DeBoot</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../build/">Building DeBoot</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">DeBooting</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#invoking">Invoking</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#vm">VM</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#metal">Metal</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#using">Using</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#pitfalls">Pitfalls</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../appliance/">Appliances</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gotcha/">Gotchas</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../inspect/">Inspecting boot images</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">DeBoot</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Using DeBoot</li>
      <li class="breadcrumb-item active">DeBooting</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="debooting">DeBooting</h1>
<h2 id="invoking">Invoking</h2>
<h3 id="vm">VM</h3>
<p>The easiest way to test your DeBoot GRUB build is to run the <code>grub/test-grub.sh</code> script from the repo root. This launches a QEMU instance with EDK2 UEFI firmware, a virtual drive backed on <code>boot.img</code>, and virtual serial console connected to the invoking terminal.</p>
<p>In principle the same approach could be used to test ARM/U-Boot builds, provided an emulator for the target board is available. However, this is generally a bigger ask than for x86 CPUs, where "generic" models are often sufficient.</p>
<h3 id="metal">Metal</h3>
<p>The other way to test this is to write <code>boot.img</code> to a removable USB drive or SD card and boot your target device from it. I use a command like </p>
<pre><code>sudo dd if=./build/boot.img of=/dev/sdc
</code></pre>
<p>to do this, but you can use whatever tool you usually use to create bootable USB drives.</p>
<h2 id="using">Using</h2>
<p>If all goes well, the boot should take you to a GRUB menu displaying various options.</p>
<ul>
<li>Most of the menu items attempt to download, mount, and switch into a squashfs hosted on Swarm.</li>
<li>One menu item has the phrase "local boot" in the description. This option does not use Swarm, or indeed the network, at all: it loads a local copy of the appliance artefact from the removable drive into memory and boots into that.</li>
<li>The last menu item takes you back to the UEFI firmware configuration utility.</li>
</ul>
<h3 id="pitfalls">Pitfalls</h3>
<p>Due to various chunk extinction events that have occurred on Swarm network upgrades, not all of the options in the default configuration of the DeBoot GRUB menu are functional.</p>
<p>If instead of a menu you end up arriving at a GRUB prompt, it means that GRUB couldn't find its own configuration file. You can help it by running the following commands:</p>
<pre><code class="language-sh">grub$&gt; set prefix=${root}/grub2
grub$&gt; normal  # Enter &quot;normal&quot; mode, i.e. GRUB boot menu
</code></pre>
<p>Note that the backspace key here functions like the usual behaviour of the delete key. If using QEMU with virtual serial console output, you may experience visual artefacts when using the shell; if the display gets messed up, clear it with the <code>clear</code> command.</p>
<p>If running via <code>grub/test-grub.sh</code>, the graphical output is not connected, and so output on the graphical terminal will not be visible. To disable the graphical terminal in initramfs, hit <code>e</code> when your target menu item is highlighted and edit the kernel commandline by deleting the expression <code>console=tty1</code>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../build/" class="btn btn-neutral float-left" title="Building DeBoot"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../appliance/" class="btn btn-neutral float-right" title="Appliances">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../build/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../appliance/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
